\documentclass[12pt,a4paper,norsk]{article}
\usepackage[T1]{fontenc,url}
\usepackage[utf8]{inputenc}
\usepackage{babel,textcomp,mathpazo,graphicx}
\usepackage{verbatim, fancyvrb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{latexsym}
\usepackage{color}
\usepackage{setspace}
\usepackage{listings}

%python highlight for listings {
\definecolor{Code}{rgb}{0,0,0}
\definecolor{Decorators}{rgb}{0.5,0.5,0.5}
\definecolor{Numbers}{rgb}{0.5,0,0}
\definecolor{MatchingBrackets}{rgb}{0.25,0.5,0.5}
\definecolor{Keywords}{rgb}{0,0,1}
\definecolor{self}{rgb}{0,0,0}
\definecolor{Strings}{rgb}{0,0.63,0}
\definecolor{Comments}{rgb}{0,0.63,1}
\definecolor{Backquotes}{rgb}{0,0,0}
\definecolor{Classname}{rgb}{0,0,0}
\definecolor{FunctionName}{rgb}{1,0.75,0.3}
\definecolor{Operators}{rgb}{0,0,0}
\definecolor{Background}{rgb}{0.98,0.98,0.98}

\lstnewenvironment{python}[1][]{
\lstset{
numbers=left,
numberstyle=\footnotesize,
numbersep=1em,
%xleftmargin=1em,
framextopmargin=2em,
framexbottommargin=2em,
showspaces=false,
showtabs=false,
showstringspaces=false,
frame=l,
tabsize=4,
% Basic
basicstyle=\ttfamily\small\setstretch{1},
backgroundcolor=\color{Background},
language=Python,
% Comments
commentstyle=\color{Comments}\slshape,
% Strings
stringstyle=\color{Strings},
morecomment=[s][\color{Strings}]{"""}{"""},
morecomment=[s][\color{Strings}]{'''}{'''},
% keywords
morekeywords={import,from,class,def,for,while,if,is,in,elif,else,not,and,or,print,break,continue,return,True,False,None,access,as,,del,except,exec,finally,global,import,lambda,pass,print,raise,try,assert},
keywordstyle={\color{Keywords}\bfseries},
% additional keywords
morekeywords={[2]@invariant},
keywordstyle={[2]\color{Decorators}\slshape},
emph={self, program, f, g, range},
emphstyle={\color{FunctionName}\slshape},
%
}}{}
%}

\begin{document}

\title{MAT1110 oblig 2}
\author{Maximiliano Horta}

\maketitle

\newpage

\begin{flushleft}
  \section*{Oppgave 1}
  \subsection*{a)}

  Vi har oppgitt en matrise A og to egenvektorer $\textbf{v}_1$ og $\textbf{v}_2$. Ved
  hjelp av formelen oppgitt multipliserer vi matrise A med egenvektorene, og skal
  få en vektor som er mulig å dividere for å få egenvektoren. Det tallet vi
  dividerer med er altså matrisens egenverdier.

  \[
  A \cdot \textbf{v}_1=
  \begin{pmatrix}
    4 & 6 \\  6 & 1
  \end{pmatrix}
  \cdot
  \begin{pmatrix}
    3 \\ 2
  \end{pmatrix}
  =
  \lambda \textbf{v}_1
  =
  \begin{pmatrix}
    24 \\ 16
  \end {pmatrix}
  =
  8
  \cdot
  \begin{pmatrix}
    3 \\ 2
  \end{pmatrix}
  \]

  \[
  A \cdot \textbf{v}_2  =
  \begin{pmatrix}
    4 & 6 \\  6 & 1
  \end{pmatrix}
  \cdot
  =
  \begin{pmatrix}
    2 \\ -3
  \end{pmatrix}
  =
  \lambda \textbf{v}_2
  =
  \begin{pmatrix}
    -10 \\ 15
  \end {pmatrix}
  =
  -5
  \cdot
  \begin{pmatrix}
    2 \\ -3
  \end{pmatrix}
  \]
  Vi har nå vist at $\textbf{v}_1$ og $\textbf{v}_2$ er egenvektorene og at de
  tilsvarende egenverdiene er: $\lambda_1 = 8$ og $ \lambda_2 = -5$

  \subsection*{b)}

  Vi vet fra tidligere fra definisjonen på skalar multiplikasjon at
  \[ (cd)\textbf{v} = (c\textbf{v})d \]
  Noe som gjør at vi kan gjøre følgende

  \[
  [c\textbf{v}]_i = c\textbf{v}_i = \textbf{v}_ic \Rightarrow  [\textbf{v}c]_i
  \Rightarrow \textbf{v}c = c\textbf{v}
  \]
  Vi vet derfor at ved å multiplisere med en konstant c, så er det egentlig samme
  vektor og vi vil derfor få samme resultat.


  \subsection*{c)}

  Ved bruk av Python og numpy modulen får vi frem at egenverdiene til matrisen A
  i oppgave a) er 8 og -5 med egenvektor
  \[
  \textbf{v}_1 =
  \begin{pmatrix}
    0.83205029 \\ 0.5547002
  \end{pmatrix}
  \quad
  \textbf{v}_2 =
  \begin{pmatrix}
    -0.5547002 \\ 0.83205029
  \end{pmatrix}
  \]

  Svarene er ca det samme så vidt jeg kan se, mest sannsynlig en 
  avrundingsfeil, men den er ganske liten.

  \subsection*{d)}

  Bruker python og finner egenverdier og egenvektorene til matrisen
  \[
  A =
  \begin{pmatrix}
    2 & -1 & 3 \\
    -1 & -2 & 1 \\
    3 & 1 & -2
  \end{pmatrix}
  \]
  Egenvektoren og egen verdiene til matrisen er da
  \\
  Egenverdier:
  \[
  \lambda_1 = 3.63674677
  \quad
  \lambda_2 = -4.38164174
  \quad
  \lambda_3 = -1.25510503
  \]
  \\
  Med følgende egenvektorer 
  \[
  %TODO fiks matrisene, skal være kolonner ikke rader.
  \textbf{v}_1 =
  \begin{pmatrix}
    -0.88573 \\ 0.43170 \\ -0.17059
  \end{pmatrix}
  \quad
  \textbf{v}_2 =
  \begin{pmatrix}
    0.07589 \\ 0.49725 \\ 0.86427
  \end{pmatrix}
  \quad
  \textbf{v}_3 =
  \begin{pmatrix}
    -0.45794 \\ -0.75257\\ 0.47319
  \end{pmatrix}
  \]
  \\
  Ved hjelp av modulen sympy, og funksjonen rref() finner jeg den
  reduserte trappeformen. Siden de er linjært uavhengige og gir oss 3
  egenvektorer danner dette et basis for $\mathbb{R}^3$


  \subsection*{e)}
  Vi skal finne egenverdiene og egenvektorene til matrisen A
  \[
  A =
  \begin{pmatrix}
    4 & 0 & 1\\2 & 3 & 2\\-1 & 0 & 2
  \end{pmatrix}
  \]
  Egenvektoren og egenveridene til matrisen A
  Egenverdier:
  \[
  \lambda_1 = 3.0 \quad \lambda_2 = 3.0 \quad \lambda_3 = 3.0
  \]
  Med følgende egenvektorer:
  \[
  \textbf{v}_1 =
  \begin{pmatrix}0.0 \\ 1.0 \\ 0.0
  \end{pmatrix}
  \quad
  \textbf{v}_2 = 
  \begin{pmatrix}
    0.67082 \\ -0.31623 \\-0.67082
  \end{pmatrix}
  \quad
  \textbf{v}_3 =
  \begin{pmatrix}
    -0.48020 \\ -0.73403 \\  0.48020
  \end{pmatrix}
  \]
  Vi finner trappesummen og ser at den reduserte trappeformen er linjært avhengig.
  \[
  trappesum =
  \begin{pmatrix}
    1.0 & 0 & -0.96041 \\0 & 1.0 & -0.71584\\0 & 0 & 0
  \end{pmatrix}
  \]
  Derfor danner ikke dette en basis

  \subsection*{f)}
  Vi har matrisen A og finner egenvektor og egenverdier ved hjelp av python og
  modulen sympy, for å regne det ut symbolsk
  \[
  A =
  \begin{pmatrix}
    3 & 1 & 0 & 0 \\ 
    -1 & 1 & 0 & 0 \\
    0 & 0 & 1 & 4 \\
    0 & 0 & 1 & 4
  \end{pmatrix}
  \]
  Egenvektorene er:
  \[
  \textbf{v}_1 =
  \begin{pmatrix}
    0 \\ 0 \\ -4 \\ 1
  \end{pmatrix}
  \quad
  \textbf{v}_2 =
  \begin{pmatrix}
    0 \\ 0 \\ 1 \\ 1
  \end{pmatrix}
  \quad
  \textbf{v}_3 =
  \begin{pmatrix}
    -1 \\ 1 \\ 0 \\ 0
  \end{pmatrix}
  \]
  Med følgende egenverdier:
  \[ \lambda_1 = 0 \quad \lambda_2 = 5 \quad \lambda_3 = 2 \]
  Vi ser nå at denne ikke kan være en basis for $\mathbb{R}^4$ da det kun er 3
  egenvektorer.

  \subsection*{g)}
  Vi bruker samme matrise som oppgave 1f). 

  \[
  \lambda_1 = 2.0 
  \quad \lambda_2 = 2.0 
  \quad\lambda_3 = 0.0 
  \quad \lambda_4 = 5.0
  \]
  \[
  \begin{pmatrix}
    0.70711 \\ -0.70711 \\ 0.0 \\ 0.0 
  \end{pmatrix}
  \begin{pmatrix}
    -0.70711 \\ 0.70711 \\ 0.0 \\ 0.0 
  \end{pmatrix}
  \begin{pmatrix}
    0.0 \\ 0.0 \\ -0.97014 \\ 0.24254 
  \end{pmatrix}
  \begin{pmatrix}
    0.0 \\ 0.0 \\ -0.70711 \\ -0.70711
  \end{pmatrix}
  \]
  Vi ser nå at hvis vi bruker python for å finne trappesummen, så får vi en
  linjært uavhengig trappesum, som består av fire vektorer og i teorien nå
  danner en basis for $\mathbb{R}^4$. 
  Dette kommer av at vi nå løser dette numerisk og derfor har en liten
  avrundingsfeil og går videre og blir større og større for hver gang vi går
  et steg videre i utregningen.


  \section*{Oppgave 2}
  \subsection*{a)}
  Se kode
  \subsection*{b)}
  \begin{figure}[h!]
    \caption{Oppgave 2b)}
    \centering
    \includegraphics[width=0.8\textwidth]{Oppgave2b}
  \end{figure}
  Mønstret man kan se her er at alle tre kurvene konvergerer mot samme punkt.
  Dette punktet er ca 1.89
  \newpage
  \subsection*{c)}
  \begin{figure}[h!]
    \caption{Oppgave 2c)}
    \centering
    \includegraphics[width=0.75\textwidth]{oppgave2c}
  \end{figure}
  skjæringspunktet er på 1.89 og er det samme som det konvergerte mot i 2b)
  \newpage
  \subsection*{d)}
  \begin{figure}[h!]
    \caption{Oppgave 2d)}
    \centering
    \includegraphics[width=0.8\textwidth]{oppgave2d}
  \end{figure}
  Vi ser her at kurven oscillierer mellom to gitt verdier.
  \newpage
  \subsection*{e)}
  \begin{figure}[h!]
    \caption{Oppgave 2e)}
    \centering
    \includegraphics[width=0.8\textwidth]{oppgave2e}
  \end{figure}
  De skjærer hverandre i toppunktet til 2d) og bunnpunktet. I tillegg til et
  punkt rett over 2.
  \subsection*{f)}
  \begin{figure}[h!]
    \caption{Oppgave 2b)}
    \centering
    \includegraphics[width=0.8\textwidth]{oppgave2f}
  \end{figure}
  Her ser vi hvor stor forskjell tallene kan ha. Ser forsåvidt ingen mønster.
  Prøvde å sammenligne med skjæringspunktet til $3sin(x)$ med $x$ men kunne ikke
  finne noe mønster mellom disse to


  \section*{Python kode}
  \subsection*{Oppgave 1}
  \begin{python}
import numpy as np
import sympy as sp

# Oppgave 1c)
A = np.Matrix('4 6;6 -1')
U,V = np.linalg.eig(A)
print " Egenvektoren og egenverdiene til matrise A i oppgave c):"
print U
print V

# Oppgave 1d)
A = np.matrix('2 -1 3; -1 -2 1; 3 1 -2')
U,V = np.linalg.eig(A)
print "Egenvektoren og egenverdiene til matrise A i oppgave d):"
print U
print V
print sp.Matrix(V).rref()

# Oppgave 1e)
A = np.matrix('4 0 1;2 3 2;-1 0 2')
U,V = np.linalg.eig(A)
print "Egenvektoren og egenverdiene til matrise A i oppgave e):"
print U
print V
print sp.Matrix(V).rref()

# Oppgave 1f)
A = sp.Matrix([[3,1,0,0],[-1,1,0,0],[0,0,1,4],[0,0,1,4]])
V = A.eigenvects()
print "Egenvektoren og egenverdiene til matrise A i oppgave f):"
print V

# Oppgave 1g)
A = np.matrix('3 1 0 0;-1 1 0 0;0 0 1 4;0 0 1 4')
U,V = np.linalg.eig(A)
print "Egenvektoren og egenverdiene til matrise A i oppgave g):"
print U
print V

''' terminal>
Egenvektoren og egenverdiene til matrise A i oppgave c):
[ 8. -5.]
[  0.83205029 -0.5547002 ]
[ 0.5547002   0.83205029]
Egenvektoren og egenverdiene til matrise A i oppgave d):
[ 3.63674677 -4.38164174 -1.25510503]
[ -0.88573564  0.43170413 -0.17059871]
[ 0.07589338  0.49725362  0.86427949]
[-0.45794385 -0.75257583  0.47319874]
(Matrix([
[1.0,   0,   0],
[  0, 1.0,   0],
[  0,   0, 1.0), [0, 1, 2])
Egenvektoren og egenverdiene til matrise A i oppgave e):
[ 3.  3.  3.]
[  0.          0.67082039 -0.48020327]
[ 1.         -0.31622777 -0.73403654]
[ 0.         -0.67082039  0.48020327
(Matrix([
[1.0,   0,   0],
[  0, 1.0,   0],
[  0,   0, 1.0), [0, 1, 2])
Egenvektoren og egenverdiene til matrise A i oppgave f):
[(0, 1, [Matrix([
[ 0],
[ 0],
[-4],
[ 1)]), (2, 2, [Matrix([
[-1],
[ 1],
[ 0],
[ 00)]), (5, 1, [Matrix([
[0],
[0],
[1],
[10)])]
Egenvektoren og egenverdiene til matrise A i oppgave g):
[ 2.00000002  1.99999998  0.          5.        ]
[  0.70710679 -0.70710677  0.         -0.        ]
[-0.70710677  0.70710679  0.         -0.        ]
[ 0.          0.         -0.9701425  -0.70710678]
[ 0.          0.          0.24253563 -0.70710678] '''

\end{python}
\newpage

  \subsection*{Oppgave 2}
  \begin{python}
    from numpy import *
    import random
    from matplotlib.pyplot import *

    # oppgave 2a)
    def program(a,x,N):
        xf = zeros(N)
        r = zeros(N)
        xf[0] = x
        if a < math.pi:
            for i in range(1,N):
                xf[i] = a*sin(xf[i-1])
            else:
                print "Error: Too big value for 'a'."

            return xf

    # Oppgave 2b) lager en loop for aa plote 3 ganger

    a = 2
    N = 50

    for i in range(0,3):
        x = random.random()*math.pi
        k = program(a,x,N)
        line = linspace(0,math.pi,N)
        hold('on')
        plot(line,k)
        title("Oppgave 2b")
    show()

    # Oppgave 2c)
    def f(a,x):
        return a*sin(x)
    hold('off')
    y = linspace(0,10,100)
    plot(y,f(2,y))
    hold('on')
    plot(y,y)
    title("Oppgave 2c")
    show()


    # Oppgave 2d)
    hold('off')
    a = 2.5
    for i in range(0,3):
        x = random.random()*math.pi
        k = program(a,x,N)
        line = linspace(0,math.pi,N)
        hold('on')
        plot(line,k)
        title("Oppgave 2d")
    show()

    #oppgave 2e)

    def g(x):
        return f(2.5,f(2.5,x))
    
    hold('off')
    plot(y,g(y))
    hold('on')
    plot(y,y)
    title("Oppgave 2e")
    show()

    # Oppgave 2f)

    hold('off')
    a = 3
    for i in range(0,3):
        x = random.random()*math.pi
        k = program(a,x,N)
        line = linspace(0,math.pi,N)
        hold('on')
        plot(line,k)
    title("Oppgave 2f")
    show()

  \end{python}


\end{flushleft}
\end{document}

