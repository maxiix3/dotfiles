#include "header.h"
/* Dette her er en metode som komprimerer filen ved gå gjennom filen og lagre 
 * hver char i 2 bytes. Det betyr du får 4 tegn i 1 byte.
 * Ved å lagre 4 char i en beholder har jeg muligheten til å lagre 4 og 4
 * tegn i en char.
 * ved bruk av bitshift så har jeg plassert bitsene i bunker på 2 og 2, altså
 * på plass 8&7, 6&5, 4&3, 2&1.
 */
int encode(char* inf, char* outf){

    FILE* in_f = fopen(inf, "r");
    FILE* out_f = fopen(outf, "w");
    char c;
    char char_beholder[4];
    int counter = 0;
    int i = 0;
    int k = 0;
    unsigned char b;
    if(in_f && out_f){
        while((c = fgetc(in_f)) != EOF){
            if(i == 4){
                b = 0;
                i = 0;
                k = 0;
                counter = 7;
                for (k=0;k<4;k++){
                    char c = char_beholder[k];
                    if (c == ' '){
                        b += 0 << counter | 0 << (counter-1);
                    } 
                    else if (c == ':'){
                        b += 0 << counter | 1 << (counter-1);
                    }
                    else if (c == '\n'){
                        b += 1 << counter | 1 << (counter-1);
                    }
                    else if (c == '@'){
                        b += 1 << counter | 0 << (counter-1);
                    }else{
                        printf("ERROR this is some invalid chars in you file");
                    }
                    counter=counter-2;
                }
                fputc(b, out_f);
            }
            char_beholder[i] = c;
            i++;
        }
    }
    fclose(in_f);
    fclose(out_f);
    return 0;
}

